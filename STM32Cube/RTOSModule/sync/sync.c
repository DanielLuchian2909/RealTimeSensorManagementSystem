/**
 ********************************************************************************
 * @file sync.c
 * @author Daniel Luchian
 * @brief
 ********************************************************************************
 */

/************************************
 * INCLUDES
 ************************************/
#include "lk_sync.h"
#include "lk_kernel.h"

/************************************
 * EXTERN VARIABLES
 ************************************/

/************************************
 * PRIVATE MACROS AND DEFINES
 ************************************/

/************************************
 * PRIVATE TYPEDEFS
 ************************************/

/************************************
 * STATIC VARIABLES
 ************************************/
INT critSectionNesting = 0; // God hopes we don't nest more than 2 billion times

/************************************
 * GLOBAL VARIABLES
 ************************************/

/************************************
 * STATIC FUNCTION PROTOTYPES
 ************************************/

/************************************
 * STATIC FUNCTIONS
 ************************************/

/************************************
 * GLOBAL FUNCTIONS
 ************************************/
//-----------------------------------------------------------------------
void
lk_enterTaskCrit()
{
	rtos_disableTaskInterrupts();
	critSectionNesting++;
}

//-----------------------------------------------------------------------
void
lk_exitTaskCrit()
{
	// TODO handle negative nest case (should never happen, however if it did, needs to be address)

	critSectionNesting--;

	if (critSectionNesting <= 0)
	{
		rtos_enableInterrupts();
	}
}

//-----------------------------------------------------------------------
void
lk_enterIrqCrit()
{

}

//-----------------------------------------------------------------------
void
lk_exitIrqCrit()
{

}
